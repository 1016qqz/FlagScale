# CUDA Hardware Configuration
# This file defines CI/CD settings for CUDA-based testing
# Test configurations are defined in tests/test_utils/config/platforms/cuda.yaml

hardware_name: cuda
display_name: "CUDA Tests"

# Docker image for this hardware
ci_image: localhost:5000/flagscale:cuda12.8.1-cudnn9.7.1-python3.12-torch2.7.1-time2510131515

# Runner labels for this hardware
runner_labels:
  - self-hosted
  - Linux
  - X64
  - nvidia-0
  - gpus-8

# Container volumes (hardware-specific paths)
container_volumes:
  - /home/flagscale_cicd/flask/static:/workspace/report
  - /home/flagscale_cicd/flask/config:/workspace/config
  - /home/flagscale_cicd/docker/docker_build/docker_data:/home/gitlab-runner/data
  - /home/flagscale_cicd/docker/docker_build/docker_tokenizers:/home/gitlab-runner/tokenizers
  - /home/flagscale_cicd/sccache:/github/home/.cache/sccache

# Container options (hardware-specific settings)
container_options: "--gpus all --shm-size=500g --hostname flagscale_cicd --user root --ulimit nofile=65535:65535"

# =============================================================================
# Package Manager Configuration
# =============================================================================
# Supported package managers: pip, uv, conda
#   - pip:   Use pip directly (standard Python)
#   - uv:    Use uv pip (fast, modern package manager)
#   - conda: Use conda environment with pip for PyPI packages
#
# Unified environment parameters:
#   - env_name: Conda environment name (for conda only)
#   - env_path: Environment path (venv path for uv, conda installation path for conda)
#
# To transition to uv in the future:
#   1. Change pkg_mgr to "uv"
#   2. Ensure uv is installed in the Docker image
#   3. Set env_path to the virtual environment path (e.g., "/opt/venv")
#
pkg_mgr: "conda"  # Current: conda for CI/CD compatibility

# Environment path (venv path for uv, conda installation path for conda)
env_path: "/root/miniconda3"

# Conda environment name (for conda only)
env_names:
  train: "flagscale-train"
  hetero_train: "flagscale-train"
  inference: "flagscale-inference"
  rl: "flagscale-rl"
